library("openxlsx")
library("tidyverse")

#Set directory to current folder
setwd(getwd())

#Import data and name columns
casamentos_data <- read.xlsx("Sources/Casamentos.xlsx", sheet = 1, colNames = FALSE, rowNames = FALSE, cols = c(1, 12, 21, 30), rows = 9:68)
colnames(casamentos_data) <- c("Anos", "Casamentos_Eslovaquia", "Casamentos_Italia", "Casamentos_Romenia")
divorcios_data <- read.xlsx("Sources/Divorcios.xlsx", sheet = 1, colNames = FALSE, rowNames = FALSE, cols = c(12, 21, 30), rows = 9:68)
colnames(divorcios_data) <- c("Divorcios_Eslovaquia", "Divorcios_Italia", "Divorcios_Romenia")

#Merge datasets
full_data = cbind(casamentos_data, divorcios_data)
full_data[full_data==0] <- NA

#Plot
ggplot(data = full_data,
       mapping = aes()) +
       geom_line(aes(Anos, Casamentos_Eslovaquia, colour = "Eslovaquia", linetype = "Casamentos"), size = 0.7) +
       geom_line(aes(Anos, Casamentos_Italia, colour = "Italia", linetype = "Casamentos"), size = 0.7) +
       geom_line(aes(Anos, Casamentos_Romenia, colour = "Romenia", linetype = "Casamentos"), size = 0.7) +
       geom_line(aes(Anos, Divorcios_Eslovaquia, colour = "Eslovaquia", linetype = "Divorcios"), size = 0.7) +
       geom_line(aes(Anos, Divorcios_Italia, colour = "Italia", linetype = "Divorcios"), size = 0.7) +
       geom_line(aes(Anos, Divorcios_Romenia, colour = "Romenia", linetype = "Divorcios"), size = 0.7) +
       scale_color_manual(name = "Paises", values = c("Eslovaquia" = "red", "Italia" = "dodgerblue3", "Romenia" = "goldenrod2")) +
       scale_linetype_manual(name = "Tipo", values = c("Casamentos" = 1, "Divorcios" = 2)) +
       labs(title = "Casamentos e Divorcios", x = "Ano", y = "Quantidade") +
       theme_bw()+
       theme(legend.position = "right", legend.title = element_text(face = "bold", size = 12), legend.text = element_text(size = 10), legend.box.background = element_rect(color="black", size=1.2))